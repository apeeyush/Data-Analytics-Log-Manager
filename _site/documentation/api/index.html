<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>API for sending Log Data</title>
    <meta name="description" content="A web based data analytics tool with data logging api and intuitive analysis interface.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://yourdomain.com/documentation/api/">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Data Analytics Log Manager</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
          <a class="page-link" href="/about">About</a>
          <a class="page-link" href="/documentation">Documentation</a>
          <a class="page-link" href="/gallery">Gallery</a>
      </div>

    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">API for sending Log Data</h1>
  </header>

  <article class="post-content">
    <p>Sending log data to Rails application is as simple as sending HTTP Post request to the service. You can send a single log or multiple logs in a single Post request. </p>

<p>A line of code speaks more than a thousand words. So here are two ways to send logs, one through the terminal and the other through the browser’s console.</p>

<h4 id="sending-logs-through-your-terminal">Sending Logs through your terminal</h4>

<p>The example below sends a log to the application straight through your terminal.</p>

<pre><code>curl -H "Content-Type: application/json" -d '{"session":"api_test_session","username":"api_test_user","time":"1234561234560","application":"TestApplication","activity": "TestActivity","event":"Testing API","parameters":{"parameter1":"value1"} , "extrakey1":"extravalue1"}' https://log-manager.herokuapp.com/api/logs
</code></pre>

<p>Here is a post request for sending multiple log events which you can try sending from terminal.</p>

<pre><code>curl -H "Content-Type: application/json" -d '[{"session":"api_test_session","username":"api_test_user","time":"1234561234560","application":"TestApplication","activity": "TestActivity","event":"Testing API","parameters":{"parameter1":"value1"} , "extrakey1":"extravalue1"}, {"session":"api_test_session","username":"api_test_user","time":"1234561234560","application":"TestApplication","activity": "TestActivity","event":"Testing API","parameters":{"parameter1":"value1"} , "extrakey1":"extravalue1"}]' http://log-manager.herokuapp.com/api/logs
</code></pre>

<h4 id="sending-logs-through-your-browsers-console">Sending Logs through your browser’s console</h4>

<p>The example below sends a log straight through your browser. In Chrome, use <code>Ctrl + Shift + J</code> (Windows/Linux) or <code>Cmd + Opt + J</code> (Mac) to open the console and execute the following.</p>

<pre><code>var data = {"session":"api_test_session","username":"api_test_user","time":"1234561234560","application":"TestApplication","activity": "TestActivity","event":"Testing API","parameters":{"parameter1":"value1"} , "extrakey1":"extravalue1"};
var request = new XMLHttpRequest();
request.open('POST', 'http://log-manager.herokuapp.com/api/logs', true);
request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
request.send(JSON.stringify(data));
</code></pre>

<p>Here is a post request for sending multiple log events which you can try sending from console.</p>

<pre><code>var data = [{"session":"api_test_session_1","username":"api_test_user","time":"1234561234560","application":"Multi Logs","activity":"TestActivity","event":"Event 1","parameters":{"parameter1":"value1","parameter2":"value2"} , "extrakey1":"extravalue1"}, {"session":"api_test_session_1","username":"api_test_user","time":"1234561234560","application":"Multi Logs","activity":"TestActivity","event":"Event 2","parameters":{"parameter1":"value1","parameter2":"value2"} , "extrakey1":"extravalue1"}];
var request = new XMLHttpRequest();
request.open('POST', 'http://log-manager.herokuapp.com/api/logs', true);
request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
request.send(JSON.stringify(data));
</code></pre>

<p>Note that you should try sending logs to your own Rails application. If you have set up a development environment, you may want to send the request to http://localhost:3000/api/logs instead of http://log-manager.herokuapp.com/api/logs.</p>

<h3 id="log-format">Log format</h3>

<p>Currently, JSON format is supported by Rails application.You should pass the json encoded log in the body of the request.</p>

<p>A single log comprises of multiple key value pairs. Eg.</p>

<pre><code>{"session":"api_test_session", "username":"api_test_user", "time":"1234561234560", "application":"TestApplication", "activity": "TestActivity", "event":"Testing API", "parameters":{"parameter1":"value1"}, "extrakey1":"extravalue1"}
</code></pre>

<p>To send multiple logs in a single post request, just send an array where each entry corresponds to a log. Eg.</p>

<pre><code>[{"session":"api_test_session_1", "username":"api_test_user", "time":"1234561234560", "application":"TestApplication", "event":"Testing API"}, {"session":"api_test_session_2", "username":"api_test_user_2", "time":"1234561234560", "application":"TestApplication", "event":"Testing API"}]
</code></pre>

<h4 id="database-structure-for-storing-logs">Database Structure for storing Logs</h4>

<pre><code>Table name: logs

id          :integer          not null, primary key
session     :string(255)
username    :string(255)
application :string(255)
activity    :string(255)
event       :string(255)
time        :datetime
parameters  :hstore
extras      :hstore
created_at  :datetime
updated_at  :datetime
event_value :string(255)
</code></pre>

<p><strong>Note:</strong></p>

<ol>
  <li><code>session</code>, <code>username</code>, <code>application</code>, <code>activity</code>, <code>event</code> and <code>time</code> are indexed by default.</li>
  <li><code>extras</code> and <code>parameters</code> are hstore data type. It essentially allows storing multiple key-value pairs in a single column. More information about it is available <a href="http://www.postgresql.org/docs/9.1/static/hstore.html">here</a> and <a href="http://postgresguide.com/sexy/hstore.html">here</a>.</li>
</ol>

<h4 id="default-api-behaviour">Default API Behaviour:</h4>

<ul>
  <li>
    <p>Values for <code>session</code>, <code>username</code>, <code>application</code>, <code>activity</code>, <code>event</code>, <code>time</code> and <code>event_value</code> are mapped directly from the corresponding value in log. So if the log contains <code>"username" : "test_user"</code>, then the log entry in database will also contain test_user as username.</p>
  </li>
  <li>
    <p>The <code>time</code> is expected to be a UTC timestamp.</p>
  </li>
  <li>
    <p>There are two hstore columns.
It may be really useful if you have some very important keys which you would like to index. You could put them in parameters and index that column.
The <code>parameters</code> key in the JSON body sent to the API is expected to contain the key-value pairs you would like to put in parameters column. For eg. <code>"parameters":{"parameter1":"value1","parameter2":"value2"}</code> will put <code>"parameter1":"value1"</code> and <code>"parameter2":"value2"</code> in parameters column.</p>
  </li>
  <li>
    <p>All other key value pairs present in the body are put in the extras column. So, if we have <code>"extrakey1":"extravalue1"</code> in the body, it will be stored in the extras column.</p>
  </li>
</ul>

<h3 id="http-response-codes">HTTP response codes</h3>

<p><strong>201 – Created</strong></p>

<p>Everything went smooth and your log(s) have been saved in the database.</p>

<p><strong>422 – Unprocessable Entity</strong></p>

<p>Something with the log message is not quite right (either malformed JSON or incorrect fields).</p>

<p><strong>500 – Internal Server Error</strong></p>

<p>As you may guess, this is because of some fault in the Rails application. Consider creating an issue on Github and we will fix it as soon as possible.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      <div class="footer-col  footer-col-1">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/apeeyush/Data-Analytics-Log-Manager">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">apeeyush/Data-Analytics-Log-Manager</span>
            </a>
          </li>
          

        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <p class="text">A web based data analytics tool with data logging api and intuitive analysis interface.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
